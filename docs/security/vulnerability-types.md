# üõ°Ô∏è Vulnerability Types & Detection

Comprehensive guide to all vulnerability types that NjordScan detects, with examples, explanations, and remediation guidance.

---

## üéØ **Vulnerability Categories**

NjordScan detects vulnerabilities across **OWASP Top 10 2021 categories** (the current standard) and **OWASP Top 10 for LLM Applications 2025** with **35+ standardized vulnerability types**:

### **OWASP Top 10 2021 Categories** (Current Standard)
1. **A01:2021 - Broken Access Control** - IDOR, privilege escalation, forced browsing
2. **A02:2021 - Cryptographic Failures** - Weak encryption, secrets exposure, insecure transport
3. **A03:2021 - Injection** - XSS, SQL injection, command injection, SSRF
4. **A04:2021 - Insecure Design** - Business logic flaws, design vulnerabilities
5. **A05:2021 - Security Misconfiguration** - Missing headers, insecure CORS, debug mode
6. **A06:2021 - Vulnerable Components** - Outdated dependencies, malicious packages
7. **A07:2021 - Authentication Failures** - Weak auth, session issues, JWT vulnerabilities
8. **A08:2021 - Software Integrity Failures** - Unsafe deserialization, code tampering
9. **A09:2021 - Logging Failures** - Insufficient logging, log injection
10. **A10:2021 - SSRF** - Server-side request forgery vulnerabilities

### **OWASP Top 10 for LLM Applications 2025**
1. **LLM01:2025 - Prompt Injection** - Malicious prompt injection attacks
2. **LLM02:2025 - Insecure Output Handling** - Unsafe handling of LLM outputs
3. **LLM03:2025 - Training Data Poisoning** - Malicious training data injection
4. **LLM04:2025 - Model Denial of Service** - Resource exhaustion attacks
5. **LLM05:2025 - Supply Chain Vulnerabilities** - Compromised models and datasets
6. **LLM06:2025 - Sensitive Information Disclosure** - Data leakage through prompts/responses
7. **LLM07:2025 - Insecure Plugin Design** - Unsafe plugin architectures
8. **LLM08:2025 - Excessive Agency** - Overly permissive LLM capabilities
9. **LLM09:2025 - Overreliance** - Overdependence on LLM outputs
10. **LLM10:2025 - Model Theft** - Unauthorized model access and extraction

### **Additional Categories**
- **ü§ñ AI-Specific Security** - Traditional AI security issues
- **‚öõÔ∏è Framework-Specific** - Next.js, React, Vite specific issues
- **‚òÅÔ∏è Cloud & Infrastructure** - Container escape, Kubernetes misconfigurations

---

## üèóÔ∏è **Standardized Vulnerability Type System**

NjordScan uses a **standardized vulnerability type system** that aligns with industry standards:

### **Key Features**
- **35+ Standardized Types**: Consistent vulnerability classification
- **OWASP Top 10 2021 Alignment**: Direct mapping to OWASP categories
- **OWASP LLM Applications 2025**: Support for AI/LLM-specific vulnerabilities
- **CWE Integration**: Common Weakness Enumeration codes
- **Automatic Enhancement**: AI-powered type normalization and metadata enrichment
- **Registry-Based**: Centralized type definitions with remediation guidance

### **Vulnerability Type Registry**
Each vulnerability type includes:
- **Type ID**: Unique identifier (e.g., `xss_reflected`)
- **Description**: Detailed explanation
- **CWE Codes**: Associated Common Weakness Enumeration codes
- **OWASP Category**: OWASP Top 10 2021 mapping
- **Remediation**: Standard fix recommendations
- **References**: External documentation links

### **Type Normalization**
```python
# Automatic type normalization
from njordscan.vulnerability_types import normalize_vulnerability_type

# These all normalize to 'xss_reflected'
normalize_vulnerability_type("XSS_REFLECTED")     # ‚Üí VulnerabilityType.XSS_REFLECTED
normalize_vulnerability_type("xss reflected")     # ‚Üí VulnerabilityType.XSS_REFLECTED
normalize_vulnerability_type("xss-reflected")     # ‚Üí VulnerabilityType.XSS_REFLECTED
```

---

## üîì **Injection Attacks**

### **Cross-Site Scripting (XSS)**

#### **Reflected XSS**
```javascript
// ‚ùå Vulnerable - Direct user input rendering
function UserProfile({ username }) {
  return <div dangerouslySetInnerHTML={{__html: username}} />;
}

// ‚úÖ Secure - Proper escaping
function UserProfile({ username }) {
  return <div>{username}</div>; // React auto-escapes
}
```

**Detection Pattern**: Standardized vulnerability type `xss_reflected`
- **Severity**: High to Critical
- **Frameworks**: All (React, Next.js, Vite)
- **AI Enhanced**: ‚úÖ Context-aware analysis
- **CWE Mapping**: CWE-79 (Cross-site Scripting)
- **OWASP Category**: A03:2021 - Injection

#### **DOM-based XSS**
```javascript
// ‚ùå Vulnerable - Direct DOM manipulation
document.getElementById('output').innerHTML = userInput;

// ‚úÖ Secure - Safe DOM manipulation
document.getElementById('output').textContent = userInput;
```

#### **Stored XSS**
```javascript
// ‚ùå Vulnerable - Storing unsanitized input
const saveComment = async (comment) => {
  await db.comments.create({ content: comment }); // No sanitization
};

// ‚úÖ Secure - Input validation and sanitization
import DOMPurify from 'dompurify';

const saveComment = async (comment) => {
  const sanitized = DOMPurify.sanitize(comment);
  await db.comments.create({ content: sanitized });
};
```

### **SQL Injection**
```javascript
// ‚ùå Vulnerable - String concatenation
const getUserById = (id) => {
  const query = `SELECT * FROM users WHERE id = ${id}`;
  return db.query(query);
};

// ‚úÖ Secure - Parameterized queries
const getUserById = (id) => {
  const query = 'SELECT * FROM users WHERE id = ?';
  return db.query(query, [id]);
};
```

**Detection Pattern**: `NJORD-SQL-001` to `NJORD-SQL-008`

### **Command Injection**
```javascript
// ‚ùå Vulnerable - Direct command execution
const { exec } = require('child_process');
exec(`ping ${userInput}`); // Dangerous!

// ‚úÖ Secure - Input validation and safe execution
const { spawn } = require('child_process');
if (!/^[\w.-]+$/.test(userInput)) {
  throw new Error('Invalid input');
}
spawn('ping', [userInput]);
```

**Detection Pattern**: `NJORD-CMD-001` to `NJORD-CMD-005`

### **NoSQL Injection**
```javascript
// ‚ùå Vulnerable - Direct object insertion
const findUser = (userData) => {
  return User.findOne(userData); // userData could be malicious object
};

// ‚úÖ Secure - Input validation
const findUser = (username) => {
  if (typeof username !== 'string') {
    throw new Error('Invalid username type');
  }
  return User.findOne({ username });
};
```

---

## üîê **Authentication & Authorization**

### **Authentication Bypass**
```javascript
// ‚ùå Vulnerable - Client-side authentication
if (user.role === 'admin') {
  // Admin functionality
}

// ‚úÖ Secure - Server-side verification
const verifyAdmin = async (token) => {
  const user = await verifyToken(token);
  return user && user.role === 'admin';
};
```

**Detection Pattern**: `NJORD-AUTH-001` to `NJORD-AUTH-012`

### **Session Management Issues**
```javascript
// ‚ùå Vulnerable - Predictable session IDs
const sessionId = Date.now().toString();

// ‚úÖ Secure - Cryptographically secure sessions
const crypto = require('crypto');
const sessionId = crypto.randomBytes(32).toString('hex');
```

### **JWT Vulnerabilities**
```javascript
// ‚ùå Vulnerable - No signature verification
const payload = jwt.decode(token); // Doesn't verify!

// ‚úÖ Secure - Proper verification
const payload = jwt.verify(token, secretKey);
```

**Detection Pattern**: `NJORD-JWT-001` to `NJORD-JWT-007`

---

## üåê **Web Application Security**

### **Cross-Site Request Forgery (CSRF)**
```javascript
// ‚ùå Vulnerable - No CSRF protection
app.post('/transfer', (req, res) => {
  transferMoney(req.body.to, req.body.amount);
});

// ‚úÖ Secure - CSRF token validation
app.use(csrf());
app.post('/transfer', csrfProtection, (req, res) => {
  transferMoney(req.body.to, req.body.amount);
});
```

**Detection Pattern**: `NJORD-CSRF-001` to `NJORD-CSRF-004`

### **Server-Side Request Forgery (SSRF)**
```javascript
// ‚ùå Vulnerable - Unrestricted URL fetching
const fetchUrl = async (url) => {
  return await fetch(url); // Can access internal services!
};

// ‚úÖ Secure - URL validation and allowlisting
const fetchUrl = async (url) => {
  const allowedHosts = ['api.example.com', 'cdn.example.com'];
  const urlObj = new URL(url);
  
  if (!allowedHosts.includes(urlObj.hostname)) {
    throw new Error('Host not allowed');
  }
  
  return await fetch(url);
};
```

**Detection Pattern**: `NJORD-SSRF-001` to `NJORD-SSRF-006`

### **Insecure Direct Object Reference (IDOR)**
```javascript
// ‚ùå Vulnerable - No authorization check
app.get('/user/:id', (req, res) => {
  const user = getUserById(req.params.id);
  res.json(user); // Anyone can access any user!
});

// ‚úÖ Secure - Authorization check
app.get('/user/:id', authenticate, (req, res) => {
  if (req.user.id !== req.params.id && !req.user.isAdmin) {
    return res.status(403).json({ error: 'Forbidden' });
  }
  const user = getUserById(req.params.id);
  res.json(user);
});
```

---

## üì¶ **Supply Chain Security**

### **Vulnerable Dependencies**
```json
// ‚ùå Vulnerable - Outdated packages with known CVEs
{
  "dependencies": {
    "lodash": "4.17.15", // CVE-2020-8203
    "axios": "0.18.0"    // CVE-2019-10742
  }
}

// ‚úÖ Secure - Updated packages
{
  "dependencies": {
    "lodash": "^4.17.21",
    "axios": "^1.6.0"
  }
}
```

**Detection Pattern**: `NJORD-DEP-001` to `NJORD-DEP-020`

### **Typosquatting Detection**
```json
// ‚ùå Suspicious - Potential typosquatting
{
  "dependencies": {
    "reqeust": "^1.0.0",    // Should be "request"
    "loadsh": "^4.0.0",     // Should be "lodash"
    "expres": "^4.0.0"      // Should be "express"
  }
}
```

### **Malicious Packages**
- **Suspicious package names** with character substitution
- **Packages with excessive permissions**
- **Packages with suspicious install scripts**
- **Recently published packages** with high download counts

### **License Compliance**
```json
// ‚ùå Problematic - GPL license in commercial project
{
  "dependencies": {
    "some-gpl-package": "^1.0.0" // GPL-3.0 license
  }
}
```

---

## ‚öôÔ∏è **Configuration Security**

### **Secrets in Configuration**
```javascript
// ‚ùå Vulnerable - Hardcoded secrets
const config = {
  apiKey: 'sk-1234567890abcdef', // OpenAI API key exposed!
  dbPassword: 'super_secret_password',
  jwtSecret: 'my-jwt-secret'
};

// ‚úÖ Secure - Environment variables
const config = {
  apiKey: process.env.OPENAI_API_KEY,
  dbPassword: process.env.DB_PASSWORD,
  jwtSecret: process.env.JWT_SECRET
};
```

**Detection Pattern**: `NJORD-SECRET-001` to `NJORD-SECRET-025`

### **Security Headers**
```javascript
// ‚ùå Vulnerable - Missing security headers
app.get('/', (req, res) => {
  res.send('<h1>Hello World</h1>');
});

// ‚úÖ Secure - Proper security headers
app.use((req, res, next) => {
  res.setHeader('X-Frame-Options', 'DENY');
  res.setHeader('X-Content-Type-Options', 'nosniff');
  res.setHeader('X-XSS-Protection', '1; mode=block');
  res.setHeader('Strict-Transport-Security', 'max-age=31536000');
  next();
});
```

### **CORS Misconfiguration**
```javascript
// ‚ùå Vulnerable - Overly permissive CORS
app.use(cors({
  origin: '*', // Allows any origin!
  credentials: true
}));

// ‚úÖ Secure - Restricted CORS
app.use(cors({
  origin: ['https://myapp.com', 'https://admin.myapp.com'],
  credentials: true
}));
```

---

## ü§ñ **AI-Specific Security**

### **API Key Exposure**
```javascript
// ‚ùå Vulnerable - API key in client-side code
const openai = new OpenAI({
  apiKey: 'sk-1234567890abcdef' // Exposed to client!
});

// ‚úÖ Secure - API key on server-side only
// Server-side only
const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});
```

**Detection Pattern**: `NJORD-AI-001` to `NJORD-AI-015`

### **Prompt Injection**
```javascript
// ‚ùå Vulnerable - Direct user input to AI
const response = await openai.chat.completions.create({
  messages: [{ role: 'user', content: userInput }] // No validation!
});

// ‚úÖ Secure - Input validation and sanitization
const sanitizePrompt = (input) => {
  // Remove potential injection attempts
  return input.replace(/system:|assistant:|ignore previous/gi, '');
};

const response = await openai.chat.completions.create({
  messages: [{ role: 'user', content: sanitizePrompt(userInput) }]
});
```

### **Unsafe AI Usage**
```javascript
// ‚ùå Vulnerable - Executing AI-generated code
const aiCode = await generateCode(userPrompt);
eval(aiCode); // Extremely dangerous!

// ‚úÖ Secure - Never execute AI-generated code directly
const aiCode = await generateCode(userPrompt);
// Review, validate, and manually implement suggestions
```

### **AI Configuration Issues**
```javascript
// ‚ùå Vulnerable - Insecure AI configuration
const response = await openai.chat.completions.create({
  temperature: 2.0,    // Too high, unpredictable
  max_tokens: 100000,  // Too high, expensive
  top_p: 1.0          // No filtering
});

// ‚úÖ Secure - Safe AI configuration
const response = await openai.chat.completions.create({
  temperature: 0.7,    // Balanced creativity
  max_tokens: 1000,    // Reasonable limit
  top_p: 0.9          // Some filtering
});
```

---

## ‚öõÔ∏è **Framework-Specific Vulnerabilities**

### **Next.js Specific**

#### **Image Optimization SSRF**
```javascript
// ‚ùå Vulnerable - Unrestricted image URLs
// next.config.js
module.exports = {
  images: {
    domains: ['*'], // Allows any domain!
  }
};

// ‚úÖ Secure - Restricted domains
module.exports = {
  images: {
    domains: ['cdn.myapp.com', 'images.unsplash.com'],
  }
};
```

**Detection Pattern**: `NJORD-NEXT-001` to `NJORD-NEXT-012`

#### **API Route Security**
```javascript
// ‚ùå Vulnerable - No authentication on API route
// pages/api/admin/users.js
export default function handler(req, res) {
  const users = getAllUsers(); // No auth check!
  res.json(users);
}

// ‚úÖ Secure - Authentication middleware
export default async function handler(req, res) {
  const user = await authenticate(req);
  if (!user || user.role !== 'admin') {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  const users = getAllUsers();
  res.json(users);
}
```

### **React Specific**

#### **Dangerous Props**
```jsx
// ‚ùå Vulnerable - Dangerous HTML rendering
function Comment({ content }) {
  return <div dangerouslySetInnerHTML={{__html: content}} />;
}

// ‚úÖ Secure - Safe content rendering
import DOMPurify from 'dompurify';

function Comment({ content }) {
  const sanitized = DOMPurify.sanitize(content);
  return <div dangerouslySetInnerHTML={{__html: sanitized}} />;
}
```

**Detection Pattern**: `NJORD-REACT-001` to `NJORD-REACT-008`

#### **State Management Security**
```javascript
// ‚ùå Vulnerable - Sensitive data in client state
const [user, setUser] = useState({
  id: 1,
  email: 'user@example.com',
  password: 'hashedpassword', // Sensitive!
  creditCard: '1234-5678-9012-3456' // Very sensitive!
});

// ‚úÖ Secure - Only necessary data in state
const [user, setUser] = useState({
  id: 1,
  email: 'user@example.com',
  name: 'John Doe'
  // Sensitive data stays on server
});
```

### **Vite Specific**

#### **Development Server Exposure**
```javascript
// ‚ùå Vulnerable - Dev server accessible in production
// vite.config.js
export default {
  server: {
    host: '0.0.0.0', // Exposed to network
    port: 3000
  }
};

// ‚úÖ Secure - Environment-specific configuration
export default {
  server: {
    host: process.env.NODE_ENV === 'development' ? 'localhost' : undefined,
    port: 3000
  }
};
```

**Detection Pattern**: `NJORD-VITE-001` to `NJORD-VITE-006`

---

## üîç **Information Disclosure**

### **Sensitive Data Exposure**
```javascript
// ‚ùå Vulnerable - Exposing internal paths
app.get('/error', (req, res) => {
  res.json({
    error: 'Database connection failed',
    path: '/usr/local/app/config/database.js', // Internal path!
    stack: error.stack // Full stack trace!
  });
});

// ‚úÖ Secure - Generic error messages
app.get('/error', (req, res) => {
  logger.error('Database connection failed', { path, stack }); // Log internally
  res.status(500).json({
    error: 'Internal server error'
  });
});
```

### **Debug Information Leakage**
```javascript
// ‚ùå Vulnerable - Debug info in production
if (process.env.NODE_ENV !== 'production') {
  console.log('Debug info:', sensitiveData); // Might leak in production!
}

// ‚úÖ Secure - Proper environment checks
if (process.env.NODE_ENV === 'development') {
  console.log('Debug info:', publicData);
}
```

### **Source Map Exposure**
```javascript
// ‚ùå Vulnerable - Source maps in production
// webpack.config.js
module.exports = {
  devtool: 'source-map' // Exposes source code!
};

// ‚úÖ Secure - No source maps in production
module.exports = {
  devtool: process.env.NODE_ENV === 'development' ? 'source-map' : false
};
```

---

## üß† **AI-Enhanced Detection**

### **Behavioral Analysis**
NjordScan's AI analyzes code patterns to detect:
- **Unusual data flows** that might indicate vulnerabilities
- **Suspicious function combinations** 
- **Anomalous security patterns**
- **Context-specific vulnerabilities**

### **Machine Learning Classification**
- **Vulnerability Confidence Scoring** (0-100%)
- **False Positive Prediction** with >95% accuracy
- **Severity Assessment** based on context
- **Impact Analysis** considering data flow

### **Threat Intelligence Integration**
- **Real-time CVE feeds** from multiple sources
- **MITRE ATT&CK** technique mapping
- **Community threat patterns**
- **Zero-day vulnerability patterns**

---

## üìä **Severity Classification**

### **Critical (9.0-10.0)**
- **Remote Code Execution (RCE)**
- **Authentication Bypass**
- **Sensitive Data Exposure**
- **SQL Injection with admin access**

### **High (7.0-8.9)**
- **Cross-Site Scripting (XSS)**
- **Server-Side Request Forgery (SSRF)**
- **Insecure Direct Object Reference (IDOR)**
- **Command Injection**

### **Medium (4.0-6.9)**
- **Cross-Site Request Forgery (CSRF)**
- **Information Disclosure**
- **Insecure Configuration**
- **Vulnerable Dependencies**

### **Low (0.1-3.9)**
- **Missing Security Headers**
- **Weak Cryptography**
- **Information Leakage**
- **Best Practice Violations**

### **Info (0.0)**
- **Code Quality Issues**
- **Performance Concerns**
- **Maintainability Issues**
- **Documentation Problems**

---

## üõ†Ô∏è **Remediation Guidance**

### **Automated Fixes**
NjordScan can automatically fix:
- **Missing security headers**
- **Outdated dependencies**
- **Basic XSS vulnerabilities**
- **Configuration issues**

```bash
# Interactive fix mode
njordscan fix --interactive

# Auto-fix safe issues
njordscan fix --safe-only

# Dry-run to see what would be fixed
njordscan fix --dry-run
```

### **Manual Remediation**
For complex issues, NjordScan provides:
- **Step-by-step fix instructions**
- **Code examples** (vulnerable vs secure)
- **Best practice recommendations**
- **Framework-specific guidance**

### **Prevention Strategies**
- **Secure coding patterns**
- **Input validation frameworks**
- **Security-focused libraries**
- **Development process improvements**

---

## üìö **Learning Resources**

### **Interactive Tutorials**
```bash
# Framework-specific tutorials
njordscan learn --framework nextjs

# Vulnerability-specific learning
njordscan learn --topic xss

# Interactive security challenges
njordscan challenges
```

### **Best Practice Guides**
- **OWASP Top 10** prevention strategies
- **Framework-specific** security patterns
- **Secure development lifecycle** integration
- **Code review checklists**

### **Community Knowledge Base**
- **Real-world vulnerability examples**
- **Community-contributed fixes**
- **Expert security insights**
- **Latest threat intelligence**

---

<div align="center">

## üõ°Ô∏è **Comprehensive Security Coverage**

**NjordScan detects 100+ vulnerability types across all major categories, powered by AI and community intelligence.**

[**üöÄ Quick Start**](../getting-started/quick-start.md) | [**üìã CLI Reference**](../user-guide/cli-reference.md) | [**üß† AI Features**](../ai/overview.md) | [**üí¨ Get Help**](https://discord.gg/njordscan)

</div>
